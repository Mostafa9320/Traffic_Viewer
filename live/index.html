<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Traffic Monitoring System</title>
    <link rel="stylesheet" href="./styles.css" />
    <link
      rel="shortcut icon"
      type="x-icon"
      sizes="16x16 32x32 64x64"
      href="/assets/images/favicon.webp"
    />
    <style>
      /* Ø£Ù†Ù…Ø§Ø· Ø¹Ø§Ù…Ø© */
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        direction: rtl;
        margin: 0;
        padding: 0;
        min-height: 100vh;
      }

      /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø­Ø§ÙˆÙŠØ© */
      .container {
        width: 100%;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #f0f0f0;
        position: relative;
        overflow: hidden;
      }

      .svg-container {
        width: 100%;
        height: 100%;
        max-width: 1200px;
        max-height: 800px;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      svg {
        width: 100%;
        height: 100%;
        max-height: 80vh;
      }

      /* Ø£Ù†Ù…Ø§Ø· Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
      .control-panel {
        position: fixed;
        top: -100%;
        left: 0;
        right: 0;
        background: white;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        transition: top 0.3s ease-in-out;
        z-index: 1000;
        max-height: 80vh;
        overflow-y: auto;
      }

      .control-panel.show {
        top: 0;
      }

      .panel-header {
        display: flex;
        justify-content: flex-end;
        margin-bottom: 20px;
      }

      .toggle-panel {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1001;
        padding: 10px 20px;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
      }

      .panel-header button {
        padding: 8px 15px;
        background-color: #e74c3c;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      /* ØªÙ†Ø³ÙŠÙ‚ Ù‚Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
      .stats-section {
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }

      .stats-section h3 {
        color: #3498db;
        margin-bottom: 15px;
        font-size: 18px;
        border-bottom: 2px solid rgba(52, 152, 219, 0.2);
        padding-bottom: 10px;
      }

      .stats-panel {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-bottom: 20px;
      }

      .stat-card {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        transition: all 0.3s ease;
        border: 1px solid #eee;
      }

      .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }

      .stat-card h4 {
        margin: 0;
        color: #7f8c8d;
        font-size: 14px;
        margin-bottom: 10px;
      }

      .stat-value {
        font-size: 24px;
        font-weight: bold;
        color: #2c3e50;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .stat-icon {
        width: 40px;
        height: 40px;
        background: #3498db;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 20px;
      }

      .stat-trend {
        font-size: 14px;
        color: #27ae60;
        display: flex;
        align-items: center;
        gap: 5px;
        margin-top: 5px;
      }

      .trend-down {
        color: #e74c3c;
      }

      /* ØªÙ†Ø³ÙŠÙ‚ Ù‚Ø³Ù… Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… */
      .congestion-section {
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }

      .congestion-section h3 {
        color: #2ecc71;
        margin-bottom: 15px;
        font-size: 18px;
        border-bottom: 2px solid rgba(46, 204, 113, 0.2);
        padding-bottom: 10px;
      }

      .congestion-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
      }

      .congestion-card {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        gap: 15px;
        border: 1px solid #eee;
        transition: all 0.3s ease;
      }

      .congestion-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }

      .direction-icon {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 20px;
      }

      .direction-north {
        background: #3498db;
      }
      .direction-south {
        background: #e74c3c;
      }
      .direction-east {
        background: #f1c40f;
      }
      .direction-west {
        background: #9b59b6;
      }

      .congestion-info {
        flex: 1;
      }

      .direction-name {
        font-size: 16px;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 5px;
      }

      .congestion-status {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .status-indicator {
        width: 10px;
        height: 10px;
        border-radius: 50%;
      }

      .level-low {
        background: #2ecc71;
        box-shadow: 0 0 8px rgba(46, 204, 113, 0.4);
      }

      .level-medium {
        background: #f1c40f;
        box-shadow: 0 0 8px rgba(241, 196, 15, 0.4);
      }

      .level-high {
        background: #e74c3c;
        box-shadow: 0 0 8px rgba(231, 76, 60, 0.4);
      }

      .status-text {
        font-size: 14px;
        color: #7f8c8d;
      }

      .car-count {
        font-size: 14px;
        color: #95a5a6;
        margin-top: 5px;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }

      .level-high {
        animation: pulse 2s infinite;
      }

      /* Ù‚Ø³Ù… Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ */
      .emergency-section {
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }

      .emergency-section h3 {
        color: #e74c3c;
        margin-bottom: 15px;
        font-size: 18px;
        border-bottom: 2px solid rgba(231, 76, 60, 0.2);
        padding-bottom: 10px;
      }

      .emergency-controls {
        background: #fff3f3;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
      }

      .emergency-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 20px;
      }

      .emergency-select {
        padding: 10px;
        border: 2px solid #ddd;
        border-radius: 6px;
        font-size: 14px;
        color: #2c3e50;
        background: white;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
      }

      .emergency-select:hover {
        border-color: #e74c3c;
      }

      .emergency-select:focus {
        outline: none;
        border-color: #e74c3c;
        box-shadow: 0 0 0 2px rgba(231, 76, 60, 0.2);
      }

      .emergency-button {
        background: #e74c3c;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
        width: 100%;
        font-size: 16px;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }

      .emergency-button:hover {
        background: #c0392b;
        transform: translateY(-1px);
      }

      .emergency-button:active {
        transform: translateY(1px);
      }

      .emergency-button i {
        font-size: 20px;
      }

      .emergency-status {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 6px;
        margin-top: 15px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .status-text {
        color: #2c3e50;
        font-weight: bold;
      }

      .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
      }

      .status-active {
        background: #e74c3c;
        animation: blink 1s infinite;
      }

      /* Ø²Ø± Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ */
      .toggle-panel {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #e74c3c;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        z-index: 999;
        font-weight: bold;
        transition: background 0.3s;
      }

      .toggle-panel:hover {
        background: #c0392b;
      }

      @media (max-width: 768px) {
        .stats-panel {
          grid-template-columns: 1fr 1fr;
        }

        .control-panel {
          max-height: 70vh;
        }
      }

      @media (max-width: 480px) {
        .stats-panel {
          grid-template-columns: 1fr;
        }
      }

      /* Emergency Alert Styles */
      .emergency-alert {
        position: fixed;
        top: -100px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #e74c3c;
        color: white;
        padding: 15px 25px;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        transition: top 0.5s ease-in-out;
      }

      .alert-content {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .emergency-icon {
        font-size: 24px;
      }

      .emergency-text {
        font-size: 16px;
        font-weight: bold;
      }

      .progress-bar {
        width: 200px;
        height: 6px;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 3px;
        overflow: hidden;
      }

      .progress {
        height: 100%;
        background: white;
        transition: width 0.3s ease-in-out;
      }

      @keyframes blink {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }

      /* ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªÙ…Ø±ÙŠØ± */
      .control-panel::-webkit-scrollbar {
        width: 8px;
      }

      .control-panel::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 4px;
      }

      .control-panel::-webkit-scrollbar-thumb {
        background: #c0392b;
        border-radius: 4px;
      }

      .control-panel::-webkit-scrollbar-thumb:hover {
        background: #e74c3c;
      }

      /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .control-panel {
        animation: fadeIn 0.5s ease-out;
      }
    </style>
  </head>
  <body style="margin: 0; padding: 0; overflow: hidden">
    <button class="toggle-panel" onclick="togglePanel()">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>

    <div class="control-panel">
      <div class="panel-header">
        <button onclick="togglePanel()">Ø§ØºÙ„Ø§Ù‚</button>
      </div>

      <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
      <div class="stats-section">
        <h3>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø±ÙˆØ±</h3>
        <div class="stats-panel">
          <div class="stat-card">
            <h4>Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±:</h4>
            <div class="stat-value" id="avgWaitTime">45s</div>
          </div>
          <div class="stat-card">
            <h4>Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª:</h4>
            <div class="stat-value" id="carCount">127</div>
          </div>
          <div class="stat-card">
            <h4>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù…:</h4>
            <div class="stat-value" id="congestionLevel">Ù…ØªÙˆØ³Ø·</div>
          </div>
          <div class="stat-card">
            <h4>Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ Ø§Ù„Ù†Ø´Ø·Ø©:</h4>
            <div class="stat-value" id="emergencyCount">0</div>
          </div>
        </div>
      </div>

      <!-- Ù‚Ø³Ù… Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… -->
      <div class="congestion-section">
        <h3>Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù…</h3>
        <div class="congestion-grid">
          <div class="congestion-card">
            <div class="direction-icon direction-north">â¬†ï¸</div>
            <div class="congestion-info">
              <div class="direction-name">Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠ</div>
              <div class="congestion-status">
                <div class="status-indicator level-low"></div>
                <div class="status-text" id="north-status">Ù…Ù†Ø®ÙØ¶</div>
              </div>
              <div class="car-count" id="north-congestion">25 Ø³ÙŠØ§Ø±Ø©</div>
            </div>
          </div>
          <div class="congestion-card">
            <div class="direction-icon direction-south">â¬‡ï¸</div>
            <div class="congestion-info">
              <div class="direction-name">Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠ</div>
              <div class="congestion-status">
                <div class="status-indicator level-medium"></div>
                <div class="status-text" id="south-status">Ù…ØªÙˆØ³Ø·</div>
              </div>
              <div class="car-count" id="south-congestion">35 Ø³ÙŠØ§Ø±Ø©</div>
            </div>
          </div>
          <div class="congestion-card">
            <div class="direction-icon direction-east">â¡ï¸</div>
            <div class="congestion-info">
              <div class="direction-name">Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø´Ø±Ù‚ÙŠ</div>
              <div class="congestion-status">
                <div class="status-indicator level-high"></div>
                <div class="status-text" id="east-status">Ù…Ø±ØªÙØ¹</div>
              </div>
              <div class="car-count" id="east-congestion">42 Ø³ÙŠØ§Ø±Ø©</div>
            </div>
          </div>
          <div class="congestion-card">
            <div class="direction-icon direction-west">â¬…ï¸</div>
            <div class="congestion-info">
              <div class="direction-name">Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„ØºØ±Ø¨ÙŠ</div>
              <div class="congestion-status">
                <div class="status-indicator level-low"></div>
                <div class="status-text" id="west-status">Ù…Ù†Ø®ÙØ¶</div>
              </div>
              <div class="car-count" id="west-congestion">25 Ø³ÙŠØ§Ø±Ø©</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Ù‚Ø³Ù… Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ -->
      <div class="emergency-section">
        <h3>Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</h3>
        <div class="emergency-controls">
          <div class="emergency-options">
            <select id="emergencyType" class="emergency-select">
              <option value="ambulance">Ø³ÙŠØ§Ø±Ø© Ø¥Ø³Ø¹Ø§Ù</option>
              <option value="police">Ø´Ø±Ø·Ø©</option>
              <option value="fire">Ø¥Ø·ÙØ§Ø¡</option>
            </select>
            <select id="emergencyDirection" class="emergency-select">
              <option value="north">Ø´Ù…Ø§Ù„</option>
              <option value="south">Ø¬Ù†ÙˆØ¨</option>
              <option value="east">Ø´Ø±Ù‚</option>
              <option value="west">ØºØ±Ø¨</option>
            </select>
          </div>
          <button class="emergency-button" onclick="activateEmergency()">
            ØªÙØ¹ÙŠÙ„ Ø­Ø§Ù„Ø© Ø·ÙˆØ§Ø±Ø¦
          </button>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="svg-container">
        <svg
          width="100%"
          height="100%"
          viewBox="0 0 1200 800"
          preserveAspectRatio="xMidYMid meet"
        >
          <defs>
            <!-- Ø³ÙŠØ§Ø±Ø© Ù…ØªØ¬Ù‡Ø© Ù„Ù„Ø´Ù…Ø§Ù„/Ø§Ù„Ø¬Ù†ÙˆØ¨ -->
            <symbol id="car-vertical">
              <rect x="0" y="0" width="40" height="60" fill="currentColor" />
              <rect x="5" y="5" width="30" height="15" fill="#333" />
              <rect x="5" y="40" width="30" height="15" fill="#333" />
              <rect x="2" y="20" width="36" height="20" fill="#666" />
              <circle cx="10" cy="50" r="3" fill="#111" />
              <circle cx="30" cy="50" r="3" fill="#111" />
              <circle cx="10" cy="10" r="3" fill="#111" />
              <circle cx="30" cy="10" r="3" fill="#111" />
            </symbol>
            <!-- Ø³ÙŠØ§Ø±Ø© Ù…ØªØ¬Ù‡Ø© Ù„Ù„Ø´Ø±Ù‚/Ø§Ù„ØºØ±Ø¨ -->
            <symbol id="car-horizontal">
              <rect x="0" y="0" width="60" height="40" fill="currentColor" />
              <rect x="5" y="5" width="15" height="30" fill="#333" />
              <rect x="40" y="5" width="15" height="30" fill="#333" />
              <rect x="20" y="2" width="20" height="36" fill="#666" />
              <circle cx="10" cy="10" r="3" fill="#111" />
              <circle cx="10" cy="30" r="3" fill="#111" />
              <circle cx="50" cy="10" r="3" fill="#111" />
              <circle cx="50" cy="30" r="3" fill="#111" />
            </symbol>
          </defs>
          <!-- Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø£ÙÙ‚ÙŠ -->
          <g id="horizontal-road">
            <!-- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠØ³Ø± -->
            <rect
              id="horizontal-road-left"
              x="200"
              y="300"
              width="280"
              height="200"
              fill="#666"
              stroke="#666"
              stroke-width="2"
            />

            <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªÙ‚Ø§Ø·Ø¹ -->
            <rect
              id="intersection"
              x="480"
              y="300"
              width="240"
              height="200"
              fill="#666"
              stroke="#666"
              stroke-width="2"
            />

            <!-- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠÙ…Ù† -->
            <rect
              id="horizontal-road-right"
              x="720"
              y="300"
              width="280"
              height="200"
              fill="#666"
              stroke="#666"
              stroke-width="2"
            />
          </g>

          <!-- Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø±Ø£Ø³ÙŠ -->
          <g id="vertical-road">
            <!-- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
            <rect
              id="vertical-road-top"
              x="480"
              y="0"
              width="240"
              height="300"
              fill="#666"
              stroke="#666"
              stroke-width="2"
            />

            <!-- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø³ÙÙ„ÙŠ -->
            <rect
              id="vertical-road-bottom"
              x="480"
              y="500"
              width="240"
              height="300"
              fill="#666"
              stroke="#666"
              stroke-width="2"
            />
          </g>

          <!-- Ø®Ø·ÙˆØ· Ø§Ù„Ø·Ø±ÙŠÙ‚ -->
          <line
            x1="200"
            y1="400"
            x2="1000"
            y2="400"
            stroke="white"
            stroke-width="4"
            stroke-dasharray="40,40"
          />
          <line
            x1="600"
            y1="100"
            x2="600"
            y2="700"
            stroke="white"
            stroke-width="4"
            stroke-dasharray="40,40"
          />

          <!-- Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± -->
          <g id="traffic-lights">
            <!-- Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ© -->
            <g id="north-light" transform="translate(600, 120)">
              <rect
                x="-25"
                y="-10"
                width="50"
                height="120"
                fill="#333"
                rx="10"
              />
              <rect x="-20" y="-5" width="40" height="110" fill="#222" rx="8" />
              <circle id="north-red" cx="0" cy="15" r="12" fill="red" />
              <circle id="north-yellow" cx="0" cy="50" r="12" fill="#333" />
              <circle id="north-green" cx="0" cy="85" r="12" fill="#333" />
            </g>

            <!-- Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ© -->
            <g id="south-light" transform="translate(600, 580)">
              <rect
                x="-25"
                y="-10"
                width="50"
                height="120"
                fill="#333"
                rx="10"
              />
              <rect x="-20" y="-5" width="40" height="110" fill="#222" rx="8" />
              <circle id="south-red" cx="0" cy="15" r="12" fill="red" />
              <circle id="south-yellow" cx="0" cy="50" r="12" fill="#333" />
              <circle id="south-green" cx="0" cy="85" r="12" fill="#333" />
            </g>

            <!-- Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø´Ø±Ù‚ÙŠØ© -->
            <g id="east-light" transform="translate(780, 400)">
              <rect
                x="-10"
                y="-25"
                width="120"
                height="50"
                fill="#333"
                rx="10"
              />
              <rect x="-5" y="-20" width="110" height="40" fill="#222" rx="8" />
              <circle id="east-red" cx="15" cy="0" r="12" fill="red" />
              <circle id="east-yellow" cx="50" cy="0" r="12" fill="#333" />
              <circle id="east-green" cx="85" cy="0" r="12" fill="#333" />
            </g>

            <!-- Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„ØºØ±Ø¨ÙŠØ© -->
            <g id="west-light" transform="translate(420, 400)">
              <rect
                x="-110"
                y="-25"
                width="120"
                height="50"
                fill="#333"
                rx="10"
              />
              <rect
                x="-105"
                y="-20"
                width="110"
                height="40"
                fill="#222"
                rx="8"
              />
              <circle id="west-red" cx="-85" cy="0" r="12" fill="red" />
              <circle id="west-yellow" cx="-50" cy="0" r="12" fill="#333" />
              <circle id="west-green" cx="-15" cy="0" r="12" fill="#333" />
            </g>
          </g>
        </svg>
      </div>
    </div>

    <script>
      let isAutomatic = false;
      let automaticInterval;
      let emergencyMode = false;
      let congestionLevels = {
        north: "low",
        south: "medium",
        east: "high",
        west: "low",
      };

      let emergencyStats = {
        active: false,
        type: null, // 'ambulance', 'police', 'fire'
        direction: null,
        startTime: null,
        duration: 20, // seconds
        affectedRoads: [],
        vehiclePosition: 0, // 0-100 progress
        clearanceZone: 20, // percentage of road to clear
      };

      // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø±ÙˆØ±
      let trafficStats = {
        waitTime: 45,
        carCount: 127,
        emergencyCount: 0,
        roads: {
          north: { cars: 25, capacity: 50 },
          south: { cars: 35, capacity: 50 },
          east: { cars: 42, capacity: 50 },
          west: { cars: 25, capacity: 50 },
        },
      };

      function getEmergencyIcon(type) {
        switch (type) {
          case "ambulance":
            return "ğŸš‘";
          case "police":
            return "ğŸš“";
          case "fire":
            return "ğŸš’";
          default:
            return "ğŸš¨";
        }
      }

      function activateEmergency() {
        const type = document.getElementById("emergencyType").value;
        const direction = document.getElementById("emergencyDirection").value;

        if (!emergencyStats.active) {
          emergencyStats.active = true;
          emergencyStats.type = type;
          emergencyStats.direction = direction;
          emergencyStats.startTime = new Date();
          emergencyStats.vehiclePosition = 0;
          emergencyMode = true;
          trafficStats.emergencyCount++;

          // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©
          determineAffectedRoads(direction);

          // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ù†Ø°Ø§Ø±
          activateEmergencyAlert(type, direction);

          // Ø¨Ø¯Ø¡ Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ© Ù…Ø±ÙƒØ¨Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦
          startEmergencySimulation();
        }
      }

      function determineAffectedRoads(primaryDirection) {
        emergencyStats.affectedRoads = [];
        const oppositeDirections = {
          north: "south",
          south: "north",
          east: "west",
          west: "east",
        };

        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙˆØ§Ù„Ù…Ø¹Ø§ÙƒØ³ Ù„Ù‡
        emergencyStats.affectedRoads.push(primaryDirection);
        emergencyStats.affectedRoads.push(oppositeDirections[primaryDirection]);

        // ØªØ­Ø¯ÙŠØ« Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ø·Ø±Ù‚ Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©
        updateTrafficLightsForEmergency();
      }

      function updateTrafficLightsForEmergency() {
        const directions = ["north", "south", "east", "west"];
        directions.forEach((dir) => {
          const isAffected = emergencyStats.affectedRoads.includes(dir);
          const isMainDirection = dir === emergencyStats.direction;

          const redLight = document.getElementById(`${dir}-red`);
          const yellowLight = document.getElementById(`${dir}-yellow`);
          const greenLight = document.getElementById(`${dir}-green`);

          if (redLight && yellowLight && greenLight) {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø£ÙˆÙ„Ø§Ù‹
            redLight.style.fill = "#333";
            yellowLight.style.fill = "#333";
            greenLight.style.fill = "#333";

            // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ ØªØ£Ø«ÙŠØ±Ø§Øª ÙˆÙ…ÙŠØ¶ Ø³Ø§Ø¨Ù‚Ø©
            redLight.style.animation = "";
            yellowLight.style.animation = "";
            greenLight.style.animation = "";

            if (isMainDirection) {
              // Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„Ø·ÙˆØ§Ø±Ø¦ - Ø£Ø®Ø¶Ø±
              greenLight.style.fill = "green";
              greenLight.style.animation = "blink 1s infinite";
            } else if (isAffected) {
              // Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ù…ØªØ£Ø«Ø±Ø© - Ø£Ø­Ù…Ø±
              redLight.style.fill = "red";
              redLight.style.animation = "blink 1s infinite";
            }
          }
        });
      }

      function activateEmergencyAlert(type, direction) {
        const alertDiv = document.createElement("div");
        alertDiv.className = "emergency-alert";
        alertDiv.innerHTML = `
                    <div class="alert-content">
                        <span class="emergency-icon">${getEmergencyIcon(
                          type
                        )}</span>
                        <span class="emergency-text">
                            Ø­Ø§Ù„Ø© Ø·ÙˆØ§Ø±Ø¦: ${
                              type === "ambulance"
                                ? "Ø¥Ø³Ø¹Ø§Ù"
                                : type === "police"
                                ? "Ø´Ø±Ø·Ø©"
                                : "Ø¥Ø·ÙØ§Ø¡"
                            }
                            ÙÙŠ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ ${
                              direction === "north"
                                ? "Ø§Ù„Ø´Ù…Ø§Ù„ÙŠ"
                                : direction === "south"
                                ? "Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠ"
                                : direction === "east"
                                ? "Ø§Ù„Ø´Ø±Ù‚ÙŠ"
                                : "Ø§Ù„ØºØ±Ø¨ÙŠ"
                            }
                        </span>
                        <div class="progress-bar">
                            <div class="progress" style="width: 0%"></div>
                        </div>
                    </div>
                `;
        document.body.appendChild(alertDiv);

        // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø¥Ù†Ø°Ø§Ø± Ù…Ù† Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©
        setTimeout(() => (alertDiv.style.top = "20px"), 100);
      }

      function startEmergencySimulation() {
        const updateInterval = 200; // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 200 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø³Ù„Ø³Ø©
        const progressInterval = setInterval(() => {
          if (emergencyStats.active) {
            // Ø²ÙŠØ§Ø¯Ø© Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙ‚Ø¯Ù… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            emergencyStats.vehiclePosition +=
              (100 * updateInterval) / (emergencyStats.duration * 1000);

            // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
            const progressBar = document.querySelector(
              ".emergency-alert .progress"
            );
            if (progressBar) {
              progressBar.style.width = `${Math.min(
                100,
                emergencyStats.vehiclePosition
              )}%`;
            }

            // Ø¥Ø®Ù„Ø§Ø¡ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø­ÙˆÙ„ Ù…Ø±ÙƒØ¨Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦
            clearEmergencyZone();

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©
            if (emergencyStats.vehiclePosition >= 100) {
              deactivateEmergency();
              clearInterval(progressInterval);
            }
          }
        }, updateInterval);
      }

      function clearEmergencyZone() {
        const mainRoad = trafficStats.roads[emergencyStats.direction];
        if (mainRoad) {
          // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ Ø¥Ø®Ù„Ø§Ø¤Ù‡Ø§
          const zoneStart = Math.max(
            0,
            emergencyStats.vehiclePosition - emergencyStats.clearanceZone / 2
          );
          const zoneEnd = Math.min(
            100,
            emergencyStats.vehiclePosition + emergencyStats.clearanceZone / 2
          );

          // ØªÙ‚Ù„ÙŠÙ„ Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©
          const clearedCars = Math.floor(
            mainRoad.cars * (emergencyStats.clearanceZone / 100)
          );
          mainRoad.cars = Math.max(0, mainRoad.cars - clearedCars);
        }
      }

      function deactivateEmergency() {
        emergencyStats.active = false;
        emergencyMode = false;

        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ù†Ø°Ø§Ø± Ø¨Ø´ÙƒÙ„ Ù…ØªØ­Ø±Ùƒ
        const alertDiv = document.querySelector(".emergency-alert");
        if (alertDiv) {
          alertDiv.style.top = "-100px";
          setTimeout(() => alertDiv.remove(), 500);
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±
        const directions = ["north", "south", "east", "west"];
        directions.forEach((dir) => {
          const lights = ["red", "yellow", "green"].map((color) =>
            document.getElementById(`${dir}-${color}`)
          );
          lights.forEach((light) => {
            if (light) light.style.animation = "";
          });
          updateTrafficLightByLevel(dir, congestionLevels[dir]);
        });

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        updateStats();
      }

      function updateCongestion() {
        for (const direction in congestionLevels) {
          const element = document.getElementById(`${direction}-congestion`);
          if (element) {
            // ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª
            const roadStats = trafficStats.roads[direction];
            const congestionPercentage =
              (roadStats.cars / roadStats.capacity) * 100;

            let text = "Ù…Ù†Ø®ÙØ¶";
            let levelClass = "level-low";

            if (congestionPercentage >= 80) {
              text = "Ù…Ø±ØªÙØ¹";
              levelClass = "level-high";
              congestionLevels[direction] = "high";
            } else if (congestionPercentage >= 50) {
              text = "Ù…ØªÙˆØ³Ø·";
              levelClass = "level-medium";
              congestionLevels[direction] = "medium";
            } else {
              congestionLevels[direction] = "low";
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Øµ Ù„ÙŠØ´Ù…Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª
            element.textContent = `${text} (${roadStats.cars} Ø³ÙŠØ§Ø±Ø©)`;
            const indicator =
              element.parentElement.querySelector(".congestion-level");
            if (indicator) {
              indicator.className = `congestion-level ${levelClass}`;
            }

            // ØªØ­Ø¯ÙŠØ« Ù„ÙˆÙ† Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙˆØ±
            updateTrafficLightByLevel(direction, congestionLevels[direction]);
          }
        }
      }

      function updateTrafficLightByLevel(direction, level) {
        if (emergencyMode) return; // Ù„Ø§ ØªØºÙŠØ± Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦

        const redLight = document.getElementById(`${direction}-red`);
        const yellowLight = document.getElementById(`${direction}-yellow`);
        const greenLight = document.getElementById(`${direction}-green`);

        if (redLight && yellowLight && greenLight) {
          // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù„ÙˆØ§Ù†
          redLight.style.fill = "#333";
          yellowLight.style.fill = "#333";
          greenLight.style.fill = "#333";

          // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù…
          switch (level) {
            case "low":
              // Ø£Ø®Ø¶Ø± ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… Ø§Ù„Ù…Ù†Ø®ÙØ¶
              greenLight.style.fill = "green";
              break;
            case "medium":
              // Ø£ØµÙØ± ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… Ø§Ù„Ù…ØªÙˆØ³Ø·
              yellowLight.style.fill = "yellow";
              break;
            case "high":
              // Ø£Ø­Ù…Ø± ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… Ø§Ù„Ù…Ø±ØªÙØ¹
              redLight.style.fill = "red";
              break;
          }
        }
      }

      function updateStats() {
        document.getElementById(
          "avgWaitTime"
        ).textContent = `${trafficStats.waitTime}s`;
        document.getElementById("carCount").textContent = trafficStats.carCount;
        document.getElementById("emergencyCount").textContent =
          trafficStats.emergencyCount;

        // ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… Ø§Ù„Ø¹Ø§Ù…
        let congestionText = "Ù…Ù†Ø®ÙØ¶";
        const highCongestionRoads = Object.values(trafficStats.roads).filter(
          (road) => road.cars / road.capacity >= 0.8
        ).length;

        if (highCongestionRoads >= 2) {
          congestionText = "Ù…Ø±ØªÙØ¹";
        } else if (highCongestionRoads === 1) {
          congestionText = "Ù…ØªÙˆØ³Ø·";
        }
        document.getElementById("congestionLevel").textContent = congestionText;
      }

      function resetTrafficLights() {
        const directions = ["north", "south", "east", "west"];
        directions.forEach((dir) => {
          const redLight = document.getElementById(`${dir}-red`);
          const yellowLight = document.getElementById(`${dir}-yellow`);
          const greenLight = document.getElementById(`${dir}-green`);

          if (redLight && yellowLight && greenLight) {
            redLight.style.fill = "#ff0000";
            yellowLight.style.fill = "#333";
            greenLight.style.fill = "#333";
          }
        });
      }

      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
      setInterval(() => {
        if (!emergencyMode) {
          // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
          trafficStats.waitTime += Math.floor(Math.random() * 5) - 2;
          if (trafficStats.waitTime < 0) trafficStats.waitTime = 0;

          // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª ÙÙŠ ÙƒÙ„ Ø·Ø±ÙŠÙ‚
          updateRoadStats();

          updateStats();
          updateCongestion();
        }
      }, 5000);

      function updateRoadStats() {
        if (!emergencyMode) {
          // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª ÙÙŠ ÙƒÙ„ Ø·Ø±ÙŠÙ‚
          for (const direction in trafficStats.roads) {
            const road = trafficStats.roads[direction];

            // Ø¥Ø¶Ø§ÙØ© Ø£Ùˆ Ø¥Ø²Ø§Ù„Ø© Ø³ÙŠØ§Ø±Ø§Øª Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
            const change = Math.floor(Math.random() * 5) - 2;
            road.cars += change;

            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ø¯Ø¯ ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø³Ù…ÙˆØ­
            if (road.cars < 0) road.cars = 0;
            if (road.cars > road.capacity) road.cars = road.capacity;
          }

          // ØªØ­Ø¯ÙŠØ« Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª
          trafficStats.carCount = Object.values(trafficStats.roads).reduce(
            (sum, road) => sum + road.cars,
            0
          );
        }
      }

      // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù…
      function updateCongestionLevel(direction, count) {
        const statusElement = document.getElementById(`${direction}-status`);
        const congestionElement = document.getElementById(
          `${direction}-congestion`
        );
        const card = statusElement.closest(".congestion-card");
        const indicator = card.querySelector(".status-indicator");

        let level = "Ù…Ù†Ø®ÙØ¶";
        let levelClass = "level-low";
        let trafficLevel = "low";

        if (count > 40) {
          level = "Ù…Ø±ØªÙØ¹";
          levelClass = "level-high";
          trafficLevel = "high";
        } else if (count > 30) {
          level = "Ù…ØªÙˆØ³Ø·";
          levelClass = "level-medium";
          trafficLevel = "medium";
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Øµ ÙˆØ§Ù„Ù…Ø¤Ø´Ø±
        statusElement.textContent = level;
        congestionElement.textContent = count + " Ø³ÙŠØ§Ø±Ø©";

        // ØªØ­Ø¯ÙŠØ« Ù„ÙˆÙ† Ø§Ù„Ù…Ø¤Ø´Ø±
        indicator.className = "status-indicator " + levelClass;

        // ØªØ­Ø¯ÙŠØ« Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        updateTrafficLightByLevel(direction, trafficLevel);
      }

      // ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
      setInterval(() => {
        const directions = ["north", "south", "east", "west"];
        directions.forEach((direction) => {
          const count = Math.floor(Math.random() * 50) + 10; // Ø¹Ø¯Ø¯ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 10 Ùˆ 60
          updateCongestionLevel(direction, count);
        });
      }, 5000);

      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
      window.addEventListener("load", () => {
        updateStats();
        resetTrafficLights();
        // ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
        const directions = ["north", "south", "east", "west"];
        directions.forEach((direction) => {
          const count = Math.floor(Math.random() * 50) + 10;
          updateCongestionLevel(direction, count);
        });
      });

      // ØªØ­Ø¯ÙŠØ« Ø£Ù†Ù…Ø§Ø· CSS Ù„Ù„Ø£Ø²Ø±Ø§Ø±
      document.addEventListener("DOMContentLoaded", function () {
        const panel = document.querySelector(".control-panel");
        const toggleButton = document.querySelector(".toggle-panel");

        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
        panel.style.top = "-100%";
        toggleButton.style.display = "block";

        // Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…Ø§Ø· Ù„Ù„Ø²Ø±
        toggleButton.style.position = "fixed";
        toggleButton.style.top = "20px";
        toggleButton.style.right = "20px";
        toggleButton.style.zIndex = "999";
        toggleButton.style.padding = "10px 20px";
        toggleButton.style.backgroundColor = "#3498db";
        toggleButton.style.color = "white";
        toggleButton.style.border = "none";
        toggleButton.style.borderRadius = "5px";
        toggleButton.style.cursor = "pointer";
        toggleButton.style.fontWeight = "bold";
      });

      // Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© togglePanel
      function togglePanel() {
        const panel = document.querySelector(".control-panel");
        if (panel.style.top === "0px") {
          panel.style.top = "-100%";
        } else {
          panel.style.top = "0px";
        }
      }
    </script>
  </body>
</html>
